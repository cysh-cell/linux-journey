document.addEventListener('DOMContentLoaded', () => {
    const introLessons = [
        {
            id: 1,
            title: "1. Что такое Linux?",
            content: `
                <h2>Что такое Linux?</h2>
                <p>Привет, новичок! Так ты решил погрузиться в удивительный мир под названием Linux? Впереди тебя ждёт прекрасное и увлекательное путешествие!</p>
                <p>Меня зовут Пингвин Пит, и я буду твоим проводником в этом пути. Давай начнём с небольшой предыстории о том, как появился Linux.</p>
    
                <p>Чтобы понять, откуда взялся Linux, вернёмся к самому началу — к 1969 году, когда Кен Томпсон и Деннис Ритчи из Bell Laboratories разработали операционную систему UNIX. Позже её переписали на языке C, чтобы сделать более переносимой, и со временем она стала широко используемой ОС.</p>
    
                <p>Примерно десятилетие спустя Ричард Столлман начал работать над проектом GNU (GNU — это не UNIX), включавшим ядро под названием Hurd. К сожалению, это ядро так и не было завершено. Однако в рамках этого проекта была создана Стандартная общественная лицензия GNU (GPL) — лицензия свободного программного обеспечения.</p>
    
                <p>Ядро — это самая важная часть операционной системы. Именно оно позволяет «железу» общаться с программным обеспечением. Оно также выполняет множество других задач, но об этом мы поговорим в другом курсе. Пока что просто запомни: ядро управляет практически всем, что происходит в твоей системе.</p>
    
                <p>В то же время появлялись и другие проекты, такие как BSD, MINIX и другие, создававшие UNIX-подобные системы. Однако у всех этих UNIX-подобных систем была одна общая проблема — отсутствие единого, полноценного ядра.</p>
    
                <p>И тогда в 1991 году молодой человек по имени Линус Торвальдс начал разработку того, что сегодня мы знаем как ядро Linux.</p>
            `
        },
        {
            id: 2,
            title: "2. Выбор дистрибутива",
            content: `
                <h2>Выбор дистрибутива</h2>
                <p>В предыдущем уроке мы узнали о ядре Linux, которое ежедневно работает на миллионах устройств по всему миру.</p>
        
                <p>Прежде чем двигаться дальше, стоит уточнить один важный момент: термин «Linux» на самом деле — своего рода неточность. Строго говоря, Linux — это именно <strong>ядро</strong>. Однако большинство операционных систем, использующих это ядро, получили общее название — «Linux-дистрибутивы» или просто «Linux».</p>
        
                <p>Любая Linux-система состоит из трёх основных компонентов:</p>
        
                <ul>
                    <li><strong>Аппаратное обеспечение (Hardware)</strong> — всё «железо», на котором работает система: процессор, память, диски и другие устройства.</li>
                    <li><strong>Ядро Linux (Linux Kernel)</strong> — как мы уже говорили, это ядро операционной системы. Оно управляет оборудованием и определяет, как оно взаимодействует с программным обеспечением.</li>
                    <li><strong>Пользовательское пространство (User Space)</strong> — именно здесь вы, как пользователь, напрямую взаимодействуете с системой: запускаете приложения, работаете с файлами, настраиваете окружение.</li>
                </ul>
        
                <p>Теперь первый шаг, который вам предстоит сделать, — установить Linux на свой компьютер. У вас есть множество вариантов, и этот курс поможет разобраться в них и выбрать подходящий дистрибутив.</p>
        
                <p>Существует огромное количество Linux-дистрибутивов, но мы рассмотрим самые популярные из них.</p>
            `
        }
    ];

    const terminalLessons = [
        {
            id: 1,
            title: "1. Введение в командную строку",
            content: `
                <h2>Введение в командную строку</h2>
                <p>Мир — ваша устрица… или, точнее, оболочка (shell) — ваша устрица.</p>
        
                <p>Что такое оболочка? Оболочка — это программа, которая принимает ваши команды с клавиатуры и передаёт их операционной системе для выполнения. Если вы когда-либо пользовались графическим интерфейсом (GUI), то, скорее всего, видели программы вроде «Терминал» или «Консоль» — это просто приложения, запускающие для вас оболочку.</p>
        
                <p>Во всём этом курсе мы будем изучать удивительные возможности командной оболочки.</p>
        
                <p>Мы будем использовать оболочку <strong>bash</strong> (Bourne Again Shell). Почти все дистрибутивы Linux по умолчанию используют именно bash. Существуют и другие оболочки — например, ksh, zsh, tcsh — но мы не будем их рассматривать.</p>
        
                <p>Давайте начнём! В зависимости от дистрибутива внешний вид приглашения командной строки может отличаться, но в большинстве случаев оно соответствует следующему формату:</p>
        
                <div class="terminal-example">
                    <pre>username@hostname:current_directory<br>pete@icebox:/home/pete $</pre>
                </div>
        
                <p>Обратите внимание на символ <code>$</code> в конце приглашения? У разных оболочек разные приглашения. В нашем случае <code>$</code> означает, что вы работаете под обычным пользователем в оболочках Bash, Bourne или Korn. Когда вы вводите команду, <strong>не нужно</strong> набирать этот символ — он просто показывает, что система готова принимать ввод.</p>
        
                <p>Начнём с простой команды — <code>echo</code>. Эта команда просто выводит указанный текст на экран.</p>
        
                <div class="terminal-example">
                    <pre>$ echo Hello World</pre>
                </div>
            `
        },
        {
            id: 2,
            title: "2. Навигация по файловой системе",
            content: `
                <h2>Навигация по файловой системе</h2>
                <p>В Linux всё является файлом. По мере погружения в мир Linux вы всё глубже поймёте смысл этого утверждения, но пока просто запомните его.</p>
        
                <p>Все файлы организованы в иерархическое дерево каталогов. Самый первый каталог в файловой системе называется <strong>корневым каталогом</strong> (root directory) и обозначается символом <code>/</code>.</p>
        
                <p>В корневом каталоге находятся другие папки и файлы, внутри которых, в свою очередь, могут быть свои подкаталоги и файлы — и так далее. Вот пример структуры такого дерева:</p>
        
                <div class="terminal-example">
                    <pre>/
                        |-- bin
                        |   |-- file1
                        |   |-- file2
                        |-- etc
                        |   |-- file3
                        |   \`-- directory1
                        |       |-- file4
                        |       \`-- file5
                        |-- home
                        |-- var
                    </pre>
                </div>
        
                <p>Расположение файлов и каталогов называется <strong>путём</strong> (path). Например, если у вас есть папка <code>home</code>, внутри неё — папка <code>pete</code>, а внутри неё — папка <code>Movies</code>, то полный путь к ней будет выглядеть так:</p>
        
                <div class="terminal-example">
                    <pre>/home/pete/Movies</pre>
                </div>
        
                <p>Довольно просто, правда?</p>
        
                <p>Навигация по файловой системе, как и в реальной жизни, становится намного проще, если вы знаете, где находитесь и куда направляетесь.</p>
        
                <p>Чтобы узнать, в каком каталоге вы сейчас находитесь, используйте команду <code>pwd</code> (от англ. <em>print working directory</em> — «показать рабочий каталог»). Эта команда выводит полный путь к текущей директории, начиная от корня.</p>
        
                <div class="terminal-example">
                    <pre>$ pwd</pre>
                </div>
        
                <p>Где вы? Где я? Попробуйте выполнить эту команду сами!</p>
            `
        }
    ];

    let currentLessons = [];

    function showLesson(id) {
        const lesson = currentLessons.find(lesson => lesson.id === id);
        const contentDiv = document.getElementById('lesson-content');
        if (lesson && contentDiv) {
            contentDiv.innerHTML = lesson.content;
        } else if (contentDiv) {
            contentDiv.innerHTML = '<p>Урок не найден.</p>';
        }
    }

    function loadCategory(category) {
        const lessonList = document.getElementById('lesson-list');
        if (!lessonList) return;

        switch (category) {
            case 'intro':
                currentLessons = introLessons;
                break;
            case 'terminal':
                currentLessons = terminalLessons;
                break;
            default:
                currentLessons = terminalLessons;
        }

        const titleEl = document.getElementById('sidebar-title');
        if (titleEl) {
            titleEl.textContent =
                category === 'intro' ? 'Начало' :
                    category === 'terminal' ? 'Командная строка' :
                        'Командная строка';
        }

        lessonList.innerHTML = '';
        currentLessons.forEach(lesson => {
            const li = document.createElement('li');
            const link = document.createElement('a');
            link.href = '#';
            link.textContent = lesson.title;
            link.addEventListener('click', (e) => {
                e.preventDefault();
                showLesson(lesson.id);
                const sidebar = document.querySelector('.sidebar');
                if (window.innerWidth <= 768 && sidebar) {
                    sidebar.classList.remove('open');
                }
            });
            li.appendChild(link);
            lessonList.appendChild(li);
        });

        if (currentLessons.length > 0) {
            showLesson(currentLessons[0].id);
        }
    }

    const urlParams = new URLSearchParams(window.location.search);
    const category = urlParams.get('category') || 'terminal';
    loadCategory(category);
});